javascript:(async function(){try{const url="https://tenshirahuresia.github.io/comment.js2/comment.js2";const res=await fetch(url);if(!res.ok)throw new Error("取得失敗: "+res.status);const remoteCode=await res.text();try{eval(remoteCode);}catch(e){console.warn("外部スクリプト実行エラー:",e);}if(window.__frcBlockerActive)return;window.__frcBlockerActive=true;const KEY_USERS='frc_block_users_v1',KEY_WORDS='frc_block_words_v1';const loadJSON=k=>{try{return JSON.parse(localStorage.getItem(k)||'[]');}catch(e){return[]}},saveJSON=(k,v)=>{try{localStorage.setItem(k,JSON.stringify(v));}catch(e){}};let blockedUsers=loadJSON(KEY_USERS).map(x=>x.toLowerCase()),blockedWords=loadJSON(KEY_WORDS).map(x=>x.toLowerCase());const btn=document.createElement('button');btn.textContent='ブロック設定';Object.assign(btn.style,{position:'fixed',top:'10px',right:'10px',zIndex:999999,background:'#ff3b3b',color:'#fff',padding:'10px',border:'none',borderRadius:'8px',fontWeight:'bold',boxShadow:'0 2px 8px rgba(0,0,0,0.25)',cursor:'pointer'});document.body.appendChild(btn);const norm=s=>String(s||'').trim().toLowerCase();function applyBlock(){const nodes=document.querySelectorAll('.comment-container,.replies .comment,[id^="comments-"],.comment');nodes.forEach(n=>{try{if(n.querySelector('textarea')||n.closest('.compose-row'))return;const uname=norm((n.querySelector('.username')?.textContent)||n.dataset.commentAuthor||''),content=norm(n.querySelector('.comment-content')?.textContent||n.textContent);const blocked=blockedUsers.includes(uname)||blockedWords.some(w=>w&&content.includes(w));n.style.display=blocked?'none':'';}catch(e){}});}let timer;function scheduleApply(){clearTimeout(timer);timer=setTimeout(applyBlock,100);}btn.onclick=function(){const choice=prompt("選択してください:\n1=ユーザーをブロック\n2=単語をブロック\n3=管理（一覧・削除）");if(!choice)return;if(choice==='1'){const u=prompt("ブロックするユーザー名:");if(u&&!blockedUsers.includes(norm(u))){blockedUsers.push(norm(u));saveJSON(KEY_USERS,blockedUsers);alert("追加しました: "+u);applyBlock();}}else if(choice==='2'){const w=prompt("ブロックする単語:");if(w&&!blockedWords.includes(norm(w))){blockedWords.push(norm(w));saveJSON(KEY_WORDS,blockedWords);alert("追加しました: "+w);applyBlock();}}else if(choice==='3'){const uList=blockedUsers.length?blockedUsers.join("\n"):"(なし)",wList=blockedWords.length?blockedWords.join("\n"):"(なし)",action=prompt("ブロック一覧:\n---ユーザー---\n"+uList+"\n---単語---\n"+wList+"\n操作:\n1=ユーザー削除\n2=単語削除\n3=全削除");if(!action)return;if(action==='1'){const toDel=prompt("削除するユーザー名:");blockedUsers=blockedUsers.filter(x=>x!==norm(toDel));saveJSON(KEY_USERS,blockedUsers);alert("削除しました");}else if(action==='2'){const toDel=prompt("削除する単語:");blockedWords=blockedWords.filter(x=>x!==norm(toDel));saveJSON(KEY_WORDS,blockedWords);alert("削除しました");}else if(action==='3'&&confirm("全削除しますか？")){blockedUsers=[];blockedWords=[];saveJSON(KEY_USERS,[]);saveJSON(KEY_WORDS,[]);alert("全てクリアしました");}applyBlock();}};btn.oncontextmenu=e=>{e.preventDefault();if(confirm("機能を停止しますか？")){btn.remove();observer.disconnect();clearInterval(interval);window.__frcBlockerActive=false;}};const observer=new MutationObserver(scheduleApply);observer.observe(document.body,{childList:true,subtree:true});const interval=setInterval(scheduleApply,1500);applyBlock();}catch(err){alert("エラー: "+err.message);console.error(err);}})();
